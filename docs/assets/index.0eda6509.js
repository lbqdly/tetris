var N=Object.defineProperty,V=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var z=(s,e,n)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,x=(s,e)=>{for(var n in e||(e={}))X.call(e,n)&&z(s,n,e[n]);if(j)for(var n of j(e))J.call(e,n)&&z(s,n,e[n]);return s},P=(s,e)=>V(s,T(e));import{o as f,c as d,r as q,n as U,a as $,b as K,d as ee,e as O,f as te,w as se,t as ne,g as oe,h as I,i as ae,F as Y,j as b,H as L,p as le,k as ie,l as Ae,m as re,u as ce,q as ge}from"./vendor.1707a1f1.js";const Ce=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))g(c);new MutationObserver(c=>{for(const C of c)if(C.type==="childList")for(const E of C.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&g(E)}).observe(document,{childList:!0,subtree:!0});function n(c){const C={};return c.integrity&&(C.integrity=c.integrity),c.referrerpolicy&&(C.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?C.credentials="include":c.crossorigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function g(c){if(c.ep)return;c.ep=!0;const C=n(c);fetch(c.href,C)}};Ce();var u={SIZE:20,COL:10,ROW:20,EACH_S:2,SPEED:1e3,SPEED_A:8};const m=[{name:"J",state:{"0*0":0,"1*0":0,"2*0":0,"3*0":0,"0*1":1,"1*1":0,"2*1":0,"3*1":0,"0*2":1,"1*2":1,"2*2":1,"3*2":0,"0*3":0,"1*3":0,"2*3":0,"3*3":0}},{name:"L",state:{"0*0":0,"1*0":0,"2*0":0,"3*0":0,"0*1":0,"1*1":0,"2*1":1,"3*1":0,"0*2":1,"1*2":1,"2*2":1,"3*2":0,"0*3":0,"1*3":0,"2*3":0,"3*3":0}},{name:"Z",state:{"0*0":0,"1*0":0,"2*0":0,"3*0":0,"0*1":1,"1*1":1,"2*1":0,"3*1":0,"0*2":0,"1*2":1,"2*2":1,"3*2":0,"0*3":0,"1*3":0,"2*3":0,"3*3":0}},{name:"S",state:{"0*0":0,"1*0":0,"2*0":0,"3*0":0,"0*1":0,"1*1":0,"2*1":1,"3*1":1,"0*2":0,"1*2":1,"2*2":1,"3*2":0,"0*3":0,"1*3":0,"2*3":0,"3*3":0}},{name:"O",state:{"0*0":0,"1*0":0,"2*0":0,"3*0":0,"0*1":0,"1*1":1,"2*1":1,"3*1":0,"0*2":0,"1*2":1,"2*2":1,"3*2":0,"0*3":0,"1*3":0,"2*3":0,"3*3":0}},{name:"T",state:{"0*0":0,"1*0":0,"2*0":0,"3*0":0,"0*1":0,"1*1":1,"2*1":0,"3*1":0,"0*2":1,"1*2":1,"2*2":1,"3*2":0,"0*3":0,"1*3":0,"2*3":0,"3*3":0}},{name:"I",state:{"0*0":0,"1*0":1,"2*0":0,"3*0":0,"0*1":0,"1*1":1,"2*1":0,"3*1":0,"0*2":0,"1*2":1,"2*2":0,"3*2":0,"0*3":0,"1*3":1,"2*3":0,"3*3":0}}];function Ie(){return m.map(s=>s.name)}function ue(){const s={};for(let e=0;e<u.ROW;e++)for(let n=0;n<u.COL;n++)s[n+"*"+e]=0;return s}class fe{constructor(e){if(this.x=3,this.y=-3,e&&Ie().indexOf(e)>=0)this.state=m.find(n=>n.name===e).state,this.name=e;else{let n=m[Math.floor(m.length*Math.random())];this.state=n.state,this.name=n.name}}}var k=(s,e)=>{for(const[n,g]of e)s[n]=g;return s};const Ee={props:{value:{type:Number},size:{type:Number,default:10}}};function de(s,e,n,g,c,C){return f(),d("div",{style:U({width:`${n.size}px`,height:`${n.size}px`}),class:$(["g",{color:Boolean(n.value)}])},[q(s.$slots,"default",{},void 0,!0)],6)}var ye=k(Ee,[["render",de],["__scopeId","data-v-25f9640c"]]);function Q(s){if(s.length<2)return s;s.sort();let e=[s[0]];for(let n=1;n<s.length;n++)s[n]!==e[e.length-1]&&e.push(s[n]);return e}const Be={components:{Block:ye},setup(){const s=[],e=K({speed:u.SPEED,isIng:!1,activeGroup:{},scroe:0,actives:[],stables:[],totalScore:0,roundCount:0,readyGroup:{}}),n=ee(null),g=O(()=>{const t=ue();return[...e.actives,...e.stables].forEach(o=>{t[o]=1}),t}),c=O(()=>{const t=[];return Object.keys(g.value).forEach(a=>{const[o,l]=a.split("*");t[l]||(t[l]=[]),t[l][o]=g.value[a]}),t}),C=O(()=>[]);function E(){e.roundCount=0,e.totalScore=0,e.stables=[],e.speed=u.SPEED,w(),h()}function B(){e.isIng=!1}function w(){e.isIng=!0,_()}function h(){for(e.actives=[];s.length<2;)s.push(new fe);e.activeGroup=s.shift(),e.readyGroup=s[0],e.speed>0&&(e.speed-=u.SPEED_A),e.roundCount+=1,e.isIng=!0}function v(t,a=0){let o=Q(e.stables),l=[];return Object.keys(t.state).forEach(i=>{let r=A(i,{x:t.x,y:t.y}).key;t.state[i]===1&&((A(r).x<0||A(r).x>u.COL-1)&&l.push(A(i).x),o.forEach(M=>{r===M&&l.push(A(i).x)}))}),Q(l).forEach(i=>{a===0?(i<2&&(console.log("\u4FEE\u590D\u5DE6\u8FB9"),t.x+=1),i>1&&(console.log("\u4FEE\u590D\u53F3\u8FB9"),t.x-=1)):a===1?i<=2&&(console.log("\u4FEE\u590D\u5DE6\u8FB9"),t.x+=1):a===2&&i>=1&&(console.log("\u4FEE\u590D\u53F3\u8FB9"),t.x-=1)}),t}function _(){p("y",1,!0),e.isIng&&setTimeout(_,e.speed)}function S(){e.isIng=!1,e.stables=Z(e.stables.concat(e.actives)),e.actives.some(t=>A(t).y<=0)?(console.log("\u89E6\u9876"),R()):(console.log("\u65B0\u4E00\u8F6E"),h())}function Z(t,a){t=Q(t);let o=[],l={};for(let i in t){let r=A(t[i]).y;l[r]?(l[r]+=1,l[r]>=u.COL&&o.push(r)):l[r]=1}return e.scroe=Math.pow(u.EACH_S,o.length),e.totalScore+=e.scroe,o.forEach(i=>{t=t.filter(r=>A(r).y!==i),t=t.map(r=>{let M=A(r).x,D=A(r).y;return D<parseInt(i)?(D+=1,M+"*"+D):r})}),t}function R(){console.log("game over !"),alert("game over!"),e.isIng=!1}function p(t="y",a=1,o=!1){if(e.isIng===!1)return;let l=F(e.activeGroup);console.log("gap:",l),t==="y"?l===0&&o?S():a>=l?e.activeGroup.y+=l:e.activeGroup.y+=a:t==="x"?(e.activeGroup.x+=a,e.activeGroup=v(e.activeGroup,a>0?2:1)):t==="o"&&(e.activeGroup.state=W(e.activeGroup.state),e.activeGroup=v(e.activeGroup,0)),e.actives=G(e.activeGroup)}function W(t){let a={"0*0":"3*0","1*0":"3*1","2*0":"3*2","3*0":"3*3","0*1":"2*0","1*1":"2*1","2*1":"2*2","3*1":"2*3","0*2":"1*0","1*2":"1*1","2*2":"1*2","3*2":"1*3","0*3":"0*0","1*3":"0*1","2*3":"0*2","3*3":"0*3"},o={};for(let l in t)o[a[l]]=t[l];return o}function G(t){const a=[];for(let o in t.state)if(t.state[o]>0){let l=parseInt(o.split("*")[0]),i=parseInt(o.split("*")[1]);l+=t.x,i+=t.y,a.push(l+"*"+i)}return a}function A(t,a){a=a||{x:0,y:0};let o=parseInt(t.split("*")[0])+a.x,l=parseInt(t.split("*")[1])+a.y;return{x:o,y:l,key:o+"*"+l}}function F(t){const a=G(t);let o=u.ROW,l=Q(e.stables);return a.forEach(i=>{u.ROW-A(i).y<o&&(o=u.ROW-A(i).y),l.forEach(r=>{A(i).x===A(r).x&&A(r).y>A(i).y&&A(r).y-A(i).y<o&&(o=A(r).y-A(i).y)})}),o-1}function H(){let t=0,a=new L(n.value);a.get("pan").set({direction:L.DIRECTION_ALL}),a.on("tap panleft panright pandown",o=>{if(o.type==="tap"){p("o");return}o.timeStamp-t<150||(o.additionalEvent==="panright"?p("x"):o.additionalEvent==="panleft"?p("x",-1):o.additionalEvent==="pandown"&&p("y"),t=o.timeStamp)}),a.get("swipe").set({direction:L.DIRECTION_VERTICAL}),a.on("swipedown",o=>{p("y",u.ROW,!0)})}return te(()=>{console.log(n),H(),E()}),se(()=>{console.log("isIng:",e.isIng),console.log("speed:",e.speed),console.log("roundCount:",e.roundCount)}),P(x({},ne(e)),{stageData:g,refStage:n,stageDataForDom:c,nextDataForDom:C,config:u,gamePause:B,gameContinue:w,gameReplay:E})}},y=s=>(le("data-v-5d7136dc"),s=s(),ie(),s),pe={class:"game"},we={class:"panel"},he=y(()=>I("div",null,null,-1)),ve=y(()=>I("i",{class:"divide"},null,-1)),me=y(()=>I("b",null,null,-1)),Qe=y(()=>I("div",null,"\u5386\u53F2\u6700\u4F73\uFF1A",-1)),Me=y(()=>I("b",null,null,-1)),De=y(()=>I("i",{class:"divide"},null,-1)),Oe=y(()=>I("div",{class:"btn-gap"},null,-1)),Le={ref:"refStage",class:"stage"};function _e(s,e,n,g,c,C){const E=oe("Block");return f(),d("div",pe,[I("div",we,[he,ve,I("div",null,"\u5F97\u5206\uFF1A"+ae(s.totalScore),1),me,Qe,Me,De,s.isIng?(f(),d("button",{key:0,onClick:e[0]||(e[0]=B=>g.gamePause())},"\u6682\u505C")):(f(),d("button",{key:1,onClick:e[1]||(e[1]=B=>g.gameContinue())},"\u7EE7\u7EED")),Oe,I("button",{onClick:e[2]||(e[2]=B=>g.gameReplay())},"\u91CD\u65B0\u5F00\u59CB")]),I("div",Le,[(f(!0),d(Y,null,b(g.stageDataForDom,(B,w)=>(f(),d("div",{class:"row",key:w},[(f(!0),d(Y,null,b(B,(h,v)=>(f(),Ae(E,{key:v,size:g.config.SIZE,value:h},null,8,["size","value"]))),128))]))),128))],512)])}var Ge=k(Be,[["render",_e],["__scopeId","data-v-5d7136dc"]]),je="data:image/png;base64,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";const ze=I("h4",null,"\u624B\u673A\u8BBF\u95EE",-1),xe=["src"],Pe={setup(s){return(e,n)=>(f(),d("div",null,[re(Ge),I("div",null,[ze,I("img",{alt:"\u624B\u673A\u8BBF\u95EE",src:ce(je),style:{width:"100px",height:"100px"}},null,8,xe)])]))}};ge(Pe).mount("#app");
